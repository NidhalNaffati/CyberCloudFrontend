<div class="edit-profile-container">
  <div class="container">
    <mat-card class="edit-profile-card">
      <mat-card-header>
        <mat-card-title>Edit Profile</mat-card-title>
        <mat-card-subtitle>Update your personal information</mat-card-subtitle>
      </mat-card-header>
      
      <mat-card-content>
        <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
          <mat-error *ngIf="error$ | async as error" class="error-message">
            {{ error.error || 'Failed to update profile. Please try again.' }}
          </mat-error>
          
          <div class="form-section">
            <h3>Basic Information</h3>
            
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Full Name</mat-label>
              <input 
                matInput 
                placeholder="Enter your full name" 
                formControlName="fullName"
              >
              <mat-error *ngIf="fullName?.hasError('required')">
                Full name is required
              </mat-error>
              <mat-error *ngIf="fullName?.hasError('minlength')">
                Full name must be at least 2 characters
              </mat-error>
              <mat-error *ngIf="fullName?.hasError('maxlength')">
                Full name must be at most 50 characters
              </mat-error>
            </mat-form-field>
            
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Bio</mat-label>
              <textarea 
                matInput 
                placeholder="Tell us about yourself" 
                formControlName="bio"
                rows="4"
              ></textarea>
              <mat-hint align="end">{{ bio?.value?.length || 0 }}/160</mat-hint>
              <mat-error *ngIf="bio?.hasError('maxlength')">
                Bio must be at most 160 characters
              </mat-error>
            </mat-form-field>
            
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Birth Date</mat-label>
              <input 
                matInput 
                [matDatepicker]="picker" 
                placeholder="MM/DD/YYYY" 
                formControlName="birthDate"
                [max]="maxDate"
              >
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
              <mat-error *ngIf="birthDate?.hasError('required')">
                Birth date is required
              </mat-error>
            </mat-form-field>
          </div>
          
          <div class="form-section">
            <h3>Profile Appearance</h3>
            
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Profile Picture URL</mat-label>
              <input 
                matInput 
                placeholder="Enter URL for your profile picture" 
                formControlName="avatarUrl"
              >
              <mat-hint>Link to an image (JPG, PNG)</mat-hint>
            </mat-form-field>
            
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Banner Image URL</mat-label>
              <input 
                matInput 
                placeholder="Enter URL for your profile banner" 
                formControlName="bannerUrl"
              >
              <mat-hint>Link to an image (JPG, PNG)</mat-hint>
            </mat-form-field>
          </div>
          
          <div class="form-section">
            <h3>Social Media Links</h3>
            
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Website</mat-label>
              <input 
                matInput 
                placeholder="https://yourdomain.com" 
                formControlName="website"
              >
              <mat-error *ngIf="website?.hasError('pattern')">
                Please enter a valid URL
              </mat-error>
            </mat-form-field>
            
            <div class="social-fields">
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Twitter</mat-label>
                <input 
                  matInput 
                  placeholder="Username without @" 
                  formControlName="twitter"
                >
                <mat-error *ngIf="twitter?.hasError('maxlength')">
                  Twitter username is too long
                </mat-error>
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Instagram</mat-label>
                <input 
                  matInput 
                  placeholder="Username without @" 
                  formControlName="instagram"
                >
                <mat-error *ngIf="instagram?.hasError('maxlength')">
                  Instagram username is too long
                </mat-error>
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Facebook</mat-label>
                <input 
                  matInput 
                  placeholder="Username or page name" 
                  formControlName="facebook"
                >
                <mat-error *ngIf="facebook?.hasError('maxlength')">
                  Facebook identifier is too long
                </mat-error>
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>LinkedIn</mat-label>
                <input 
                  matInput 
                  placeholder="Username (what comes after /in/)" 
                  formControlName="linkedin"
                >
                <mat-error *ngIf="linkedin?.hasError('maxlength')">
                  LinkedIn username is too long
                </mat-error>
              </mat-form-field>
            </div>
          </div>
          
          <div class="form-actions">
            <button 
              mat-stroked-button 
              type="button" 
              routerLink="/profile/{{ (currentUser$ | async)?.username }}"
            >
              Cancel
            </button>
            <button 
              mat-flat-button 
              color="primary" 
              type="submit" 
              [disabled]="profileForm.invalid || (loading$ | async)"
            >
              <mat-spinner diameter="20" *ngIf="loading$ | async"></mat-spinner>
              <span *ngIf="!(loading$ | async)">Save Changes</span>
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>
